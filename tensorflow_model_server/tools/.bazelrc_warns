build --copt=-Werror

# disable abi change warns since everything is built from source
build --copt=-Wno-psabi

# upstream (serving) ignored warnings

build --copt=-Wno-error=sign-compare
build --copt=-Wno-error=deprecated-declarations
build --copt=-Wno-error=comment
build --copt=-Wno-error=maybe-uninitialized
build --copt=-Wno-error=return-type
build --copt=-Wno-error=strict-aliasing
build --copt=-Wno-error=unused-function
build --copt=-Wno-error=unused-result
build --copt=-Wno-error=unknown-pragmas
build --copt=-Wno-error=unused-but-set-parameter
build --copt=-Wno-error=parentheses
build --copt=-Wno-error=unused-but-set-variable
build --copt=-Wno-error=unused-variable
build --copt=-Wno-error=format=

# warnings that don't exist in gcc 4.8, but do in gcc >= 8.3

build --copt=-Wno-error=tautological-compare
build --copt=-Wno-error=format-truncation=
build --copt=-Wno-error=ignored-attributes
build --copt=-Wno-error=class-memaccess
build --cxxopt=-Wno-class-memaccess
build --host_cxxopt=-Wno-class-memaccess

# warnings in gcc 4.8, but where diagnosis might be improved in >= 8.3

# possible buffer overflow bug in tensorflow transitive dependency
# (icu4c) exposed by newer gcc (-O3)
build --copt=-Wno-error=array-bounds

# possible false positive due to macro interference
# @org_tensorflow/tensorflow/core/kernels/cast_op.h:299:12
build --copt=-Wno-error=uninitialized

# possible gcc 8.3 regression
# https://gcc.gnu.org/bugzilla/show_bug.cgi?id=83239
build --copt=-Wno-error=stringop-overflow=

# these all seem to be over-alignment warnings, but I think these data
# alignments are used for SIMD operations (Eigen, highwayhash). not sure
# why this warns only on arm(64) as max_align_t is 16 for amd64 and arm64
build:common_arm --copt=-Wno-error=attributes

# overflow warning in:
# @org_tensorflow/tensorflow/core/platform/cloud/gcs_file_system.cc:107
# max cache ttl effectively uses max(size_t) which is platform specific, but
# truncation will yeild the max for whatever size_t is since these are unsigned
build:linux_arm --copt=-Wno-error=overflow

# upstream (tensorflow) disabled diagnostics

build --copt=-Wno-sign-compare
build:linux_arm --copt=-Wno-narrowing
